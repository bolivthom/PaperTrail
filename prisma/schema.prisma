generator client {
  provider = "prisma-client-js"
  output   = "../generated/prisma"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model categories {
  id          String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  name        String     @unique @db.VarChar(100)
  description String?
  created_at  DateTime?  @default(now()) @db.Timestamptz(6)
  receipts    receipts[]
}

model receipts {
  id              String      @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  user_id         String?     @db.Uuid
  company_name    String      @db.VarChar(255)
  company_address String?
  purchase_date   DateTime    @db.Date
  sub_total       Decimal?    @default(0.00) @db.Decimal(12, 2)
  tax_amount      Decimal?    @default(0.00) @db.Decimal(12, 2)
  total_amount    Decimal     @db.Decimal(12, 2)
  currency        String?     @default("JMD") @db.VarChar(10)
  notes           String?
  image_data      Bytes?
  image_mime_type String?     @db.VarChar(50)
  image_filename  String?     @db.VarChar(255)
  created_at      DateTime?   @default(now()) @db.Timestamptz(6)
  updated_at      DateTime?   @default(now()) @db.Timestamptz(6)
  category_id     String?     @db.Uuid
  categories      categories? @relation(fields: [category_id], references: [id], onUpdate: NoAction)
  users           users?      @relation(fields: [user_id], references: [id], onDelete: Cascade, onUpdate: NoAction)

  @@index([company_name], map: "idx_receipts_company_name")
  @@index([purchase_date], map: "idx_receipts_date")
  @@index([total_amount], map: "idx_receipts_total_amount")
  @@index([user_id], map: "idx_receipts_user_id")
}

model users {
  id          String     @id @default(dbgenerated("gen_random_uuid()")) @db.Uuid
  email       String     @unique @db.VarChar(255)
  first_name  String?    @db.VarChar(100)
  last_name   String?    @db.VarChar(100)
  is_verified Boolean?   @default(false)
  created_at  DateTime?  @default(now()) @db.Timestamptz(6)
  updated_at  DateTime?  @default(now()) @db.Timestamptz(6)
  receipts    receipts[]
}
